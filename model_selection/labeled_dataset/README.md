# AIS Gaps Training Set Pipeline

This directory contains code to generate the gaps training set labeled using Exact Earth. Note that the training set does not filter by distance to shore so additional filters must still be applied. Do not use the table generated by this pipeline as the training set without additional filters or an understanding of what the dataset is without those filters. Currently those filters are:

SELECT *  
FROM  
  `proj_ais_gaps_catena.ais_gap_events_labeled_vYYYYMMDD`   
WHERE  
  (off_distance_from_shore_m >= 50*1852 AND on_distance_from_shore_m >= 50*1852)
  AND positions_per_day_off > 5 AND positions_per_day_on > 5`

**NOTE:** This code requires access to the Global Fishing Watch BigQuery project and tables.

# Files

+ `pipe_gaps_labeled.py`: Jupyter notebook (use `jupytext` to open from `.py`) to execute the query that generates the labeled training set for the gaps model.

+ `ais_gap_events_labeled.sql.j2`: This SQL file contains the query that generates the Exact Earth metrics for gaps that have Exact Earth data and labels them as true or false gaps. The table produced by this query is used for model selection.

+ `config.py`: Configuration file with table names to use in `pipe_gaps_labeled.py`.
  
